"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[51089],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>d});var a=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var s=a.createContext({}),p=function(e){var t=a.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),u=p(r),d=n,h=u["".concat(s,".").concat(d)]||u[d]||m[d]||o;return r?a.createElement(h,l(l({ref:t},c),{},{components:r})):a.createElement(h,l({ref:t},c))}));function d(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,l=new Array(o);l[0]=u;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:n,l[1]=i;for(var p=2;p<o;p++)l[p]=r[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,r)}u.displayName="MDXCreateElement"},24964:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>m,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var a=r(87462),n=(r(67294),r(3905));const o={},l=void 0,i={unversionedId:"demos/firebase-streams-ext",id:"demos/firebase-streams-ext",title:"firebase-streams-ext",description:"Download",source:"@site/docs/demos/firebase-streams-ext.md",sourceDirName:"demos",slug:"/demos/firebase-streams-ext",permalink:"/Moralis-JS-SDK/demos/firebase-streams-ext",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"sidebar",previous:{title:"firebase-proxy",permalink:"/Moralis-JS-SDK/demos/firebase-proxy"},next:{title:"firebase-streams-monitor",permalink:"/Moralis-JS-SDK/demos/firebase-streams-monitor"}},s={},p=[{value:"\ud83d\ude80 How to Start",id:"-how-to-start",level:2},{value:"\ud83d\udd0c Run Locally",id:"-run-locally",level:3},{value:"\ud83d\udd25 Deploy to Production",id:"-deploy-to-production",level:3},{value:"\ud83d\udea8 Firestore Rules",id:"-firestore-rules",level:2}],c={toc:p};function m(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://moralisweb3.github.io/Moralis-JS-SDK/downloads/firebase-streams-ext.zip"},"Download")),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/MoralisWeb3/Moralis-JS-SDK/tree/main/demos/firebase-streams-ext"},"View code")),(0,n.kt)("hr",null),(0,n.kt)("p",null,"This project contains a simple demo of the Listen Blockchain by Moralis Streams extension for the Firebase."),(0,n.kt)("p",null,"Required Google Cloud services:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://firebase.google.com/docs/hosting"},"Firebase Hosting")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://firebase.google.com/docs/functions"},"Firebase Cloud Functions")," (only in the Blaze plan, check the ",(0,n.kt)("a",{parentName:"li",href:"https://firebase.google.com/pricing"},"pricing"),")."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://cloud.google.com/secret-manager/"},"Secret Manager")," (check the ",(0,n.kt)("a",{parentName:"li",href:"https://cloud.google.com/secret-manager/pricing"},"pricing"),")")),(0,n.kt)("h2",{id:"-how-to-start"},"\ud83d\ude80 How to Start"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Clone this repo."),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("a",{parentName:"li",href:"https://firebase.google.com/docs/cli"},"Install Firebase CLI")," globally: ",(0,n.kt)("inlineCode",{parentName:"li"},"yarn global add firebase-tools")),(0,n.kt)("li",{parentName:"ol"},"Login to your account: ",(0,n.kt)("inlineCode",{parentName:"li"},"firebase login")),(0,n.kt)("li",{parentName:"ol"},"Get list of your projects: ",(0,n.kt)("inlineCode",{parentName:"li"},"firebase projects:list"),". If this list is empty you should add a new project. You can do it by the Firebase Console."),(0,n.kt)("li",{parentName:"ol"},"Set your project ID: ",(0,n.kt)("inlineCode",{parentName:"li"},"firebase use <PROJECT_ID>")),(0,n.kt)("li",{parentName:"ol"},"Install the Listen Blockchain by Moralis Streams extension: ",(0,n.kt)("inlineCode",{parentName:"li"},"firebase ext:install moralis/moralis-streams"),"."),(0,n.kt)("li",{parentName:"ol"},"Build the functions project:",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"cd functions")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"yarn install")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"yarn run build"))))),(0,n.kt)("h3",{id:"-run-locally"},"\ud83d\udd0c Run Locally"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("a",{parentName:"li",href:"https://www.oracle.com/java/technologies/javase/jdk18-archive-downloads.html"},"Install Java")," on your computer. Functions Emulator requires Java."),(0,n.kt)("li",{parentName:"ol"},"Run emulators: ",(0,n.kt)("inlineCode",{parentName:"li"},"firebase emulators:start")),(0,n.kt)("li",{parentName:"ol"},"Determine the ",(0,n.kt)("strong",{parentName:"li"},"local webhook URL"),". You can find the URL in logs of the Emulator. Open ",(0,n.kt)("inlineCode",{parentName:"li"},"http://localhost:4000/functions")," in your browser. The URL should look like this: ",(0,n.kt)("inlineCode",{parentName:"li"},"http://localhost:5001/<project_id>/<location>/ext-moralis-streams-webhook"),"."),(0,n.kt)("li",{parentName:"ol"},"Run the ngrok to forward requests from an internet address to your localhost:",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"cd functions")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"yarn run ngrok")))),(0,n.kt)("li",{parentName:"ol"},"Determine the ",(0,n.kt)("strong",{parentName:"li"},"public webhook URL"),". The URL has hostname and port from the ngrok, and the path from the local webhook URL. This URL will be needed in the next step.\\\nFor example: ",(0,n.kt)("inlineCode",{parentName:"li"},"https://baa0-89-151-39-84.ngrok.io/moralis-x6/us-central1/ext-moralis-streams-webhook")),(0,n.kt)("li",{parentName:"ol"},"We need to add some streams to see the demo in action. Open the Moralis admin panel and add below streams.",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"ERC20 Transfers")," stream:",(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre"},"Address: 0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48\nDescription: USDC Token\nTag: ERC20 Transfer\nTopic: \u2713 Transfer\nChain: Ethereum Mainnet\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Wallet Transfers")," stream:",(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre"},"Address: 0xDFd5293D8e347dFe59E90eFd55b2956a1343963d\nDescription: Binance 16 Transactions\nTag: Transaction\nChain: Ethereum Mainnet\n"))))),(0,n.kt)("li",{parentName:"ol"},"Open ",(0,n.kt)("inlineCode",{parentName:"li"},"http://localhost:5555/")," in your browser.")),(0,n.kt)("h3",{id:"-deploy-to-production"},"\ud83d\udd25 Deploy to Production"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Deploy: ",(0,n.kt)("inlineCode",{parentName:"li"},"firebase deploy")),(0,n.kt)("li",{parentName:"ol"},"If you have any problem with the CORS on the production, probably you should allow unauthenticated HTTP function invocation. To allow unauthenticated invocation you must specify this at or after deployment. ",(0,n.kt)("a",{parentName:"li",href:"https://cloud.google.com/functions/docs/securing/managing-access-iam#allowing_unauthenticated_http_function_invocation"},"Here")," you can read more about it.")),(0,n.kt)("h2",{id:"-firestore-rules"},"\ud83d\udea8 Firestore Rules"),(0,n.kt)("p",null,"This demo has already set the below Firestore security rules, check the ",(0,n.kt)("a",{parentName:"p",href:"./firestore.rules"},"firestore.rules")," file. ",(0,n.kt)("strong",{parentName:"p"},"Don't forget to set it to your own project"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"rules_version = '2';\n\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    match /moralis/{collectionType}/{collectionName}/{id} {\n      allow read;\n      allow write: if false;\n    }\n  }\n}\n")))}m.isMDXComponent=!0}}]);